{
  "context": {
    "version": "2.0.0",
    "action": "on_discover",
    "timestamp": "2024-10-04T10:00:05Z",
    "message_id": "msg-on-discover-tariff-001",
    "transaction_id": "txn-tariff-energy-001",
    "bap_id": "bap.energy-consumer.com",
    "bap_uri": "https://bap.energy-consumer.com",
    "bpp_id": "bpp.utility-company.com",
    "bpp_uri": "https://bpp.utility-company.com",
    "ttl": "PT30S",
    "domain": "energy-trade"
  },
  "message": {
    "catalogs": [
      {
        "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/draft/schema/core/v2/context.jsonld",
        "@type": "beckn:Catalog",
        "beckn:id": "catalog-utility-tariff-001",
        "beckn:descriptor": {
          "@type": "beckn:Descriptor",
          "schema:name": "Utility Grid Power - Time-of-Use Tariff",
          "beckn:shortDesc": "Tariff-based P2P trading (SELLER + BUYER roles with tariff object)"
        },
        "beckn:offers": [
          {
            "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/draft/schema/core/v2/context.jsonld",
            "@type": "beckn:Offer",
            "beckn:id": "offer-utility-tariff-001",
            "beckn:descriptor": {
              "@type": "beckn:Descriptor",
              "schema:name": "Time-of-Use Tariff - Residential"
            },
            "beckn:provider": "bpp.utility-company.com",
            "beckn:price": {
              "@type": "schema:PriceSpecification",
              "schema:price": 0.0,
              "schema:priceCurrency": "INR",
              "schema:unitText": "kWh",
              "schema:valueAddedTaxIncluded": false
            },
            "beckn:offerAttributes": {
              "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/draft/schema/EnergyOffer/v1/context.jsonld",
              "@type": "EnergyOffer",
              "offerId": "offer-utility-tariff-001",
              "contractId": "contract-tariff-p2p-001",
              "providerId": "bpp.utility-company.com",
              "providerUri": "https://bpp.utility-company.com",
              "openRole": "BUYER",
              "contractSummary": "Tariff-based P2P trading: SELLER provides tariff object (time-of-use), BUYER provides contractedQuantity",
              "contract": {
                "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/draft/schema/EnergyContractP2PTrade/v1/context.jsonld",
                "@type": "EnergyContractP2PTrade",
                "contractId": "contract-tariff-p2p-001",
                "status": "PENDING",
                "createdAt": "2024-10-04T10:00:00Z",
                "roles": [
                  {
                    "role": "SELLER",
                    "filledBy": "bpp.utility-company.com",
                    "filled": true,
                    "roleInputs": {
                      "sourceMeterId": "grid-meter-001",
                      "sourceType": "GRID",
                      "tariff": {
                        "tariffId": "TOU-2024-001",
                        "currency": "INR",
                        "type": "REGULAR",
                        "tariffAltText": [
                          {
                            "language": "en",
                            "text": "Time-of-Use Tariff - Residential"
                          }
                        ],
                        "tariffAltUrl": "https://utility.com/tariffs/tou-2024-001",
                        "minPrice": {
                          "exclVat": 0.10,
                          "inclVat": 0.118
                        },
                        "maxPrice": {
                          "exclVat": 0.20,
                          "inclVat": 0.236
                        },
                        "elements": [
                          {
                            "priceComponents": [
                              {
                                "type": "ENERGY",
                                "price": 0.20,
                                "vat": 18.0,
                                "stepSize": 1
                              }
                            ],
                            "restrictions": {
                              "startTime": "18:00",
                              "endTime": "22:00",
                              "dayOfWeek": ["MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY"]
                            }
                          },
                          {
                            "priceComponents": [
                              {
                                "type": "ENERGY",
                                "price": 0.10,
                                "vat": 18.0,
                                "stepSize": 1
                              }
                            ],
                            "restrictions": {
                              "startTime": "22:00",
                              "endTime": "06:00"
                            }
                          },
                          {
                            "priceComponents": [
                              {
                                "type": "ENERGY",
                                "price": 0.15,
                                "vat": 18.0,
                                "stepSize": 1
                              }
                            ],
                            "restrictions": {
                              "startTime": "06:00",
                              "endTime": "18:00"
                            }
                          }
                        ],
                        "energyMix": {
                          "isGreenEnergy": false,
                          "energySources": [
                            {
                              "source": "COAL",
                              "percentage": 60.0
                            },
                            {
                              "source": "SOLAR",
                              "percentage": 40.0
                            }
                          ],
                          "environImpact": {
                            "carbonDioxide": 450.0
                          },
                          "supplierName": "State Utility Co",
                          "energyProductName": "Mixed Grid Power"
                        }
                      }
                    }
                  },
                  {
                    "role": "BUYER",
                    "filledBy": null,
                    "filled": false,
                    "roleInputs": {}
                  }
                ],
                "inputParameters": {
                  "validityWindow": {
                    "startTime": "2024-10-04T00:00:00Z",
                    "endTime": "2024-10-05T23:59:59Z"
                  },
                  "pricingModel": "TIME_OF_DAY"
                },
                "inputSignals": [],
                "telemetrySources": [],
                "revenueFlows": {
                  "flows": [
                    {
                      "from": "BUYER",
                      "to": "SELLER",
                      "formula": "computeTariffPrice(roles.SELLER.roleInputs.tariff, roles.BUYER.roleInputs.tradeStartTime, roles.BUYER.roleInputs.tradeEndTime, deliveredQuantity) × deliveredQuantity",
                      "description": "Compute price from time-of-use tariff: peak (18:00-22:00) @ ₹0.20/kWh, off-peak (22:00-06:00) @ ₹0.10/kWh, mid-peak (06:00-18:00) @ ₹0.15/kWh"
                    }
                  ],
                  "netZero": true
                },
                "qualityMetrics": {
                  "metrics": []
                }
              }
            }
          }
        ]
      }
    ]
  }
}

